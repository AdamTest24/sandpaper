<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Lesson Runtime Dependency Management — manage_deps • sandpaper</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Lesson Runtime Dependency Management — manage_deps" />
<meta property="og:description" content="A customized provisioner for Carpentries Lessons based on
renv that will install and maintain the requirements for the lesson
while respecting user environments. This setup leads to several
advantages:
reliable setup: the version of the lesson built on the carpentries
website will be the same as what you build on your computer because the
packages will be identical
environmentally friendly: The lesson dependencies are NOT stored in
your default R library and they will not alter your R environment.
transparent: any additions or deletions to the cache will be recorded
in the lockfile, which is tracked by git.


The functions that control this cache are the following:
manage_deps(): Creates and updates the dependencies in your lesson.
If no lockfile exists in your lesson, this will create one for you.
update_cache(): fetches updates for the dependencies and applies them
to your cache and lockfile.


This is a wrapper around renv::record(), which helps you record a package
or set of packages in your lockfile. It can be useful when you want to
upgrade or downgrade a specific package." />
<meta name="twitter:card" content="summary" />
<meta name="twitter:creator" content="@zkamvar" />
<meta name="twitter:site" content="@thecarpentries" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sandpaper</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9065</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/building-with-renv.html">Building Lessons With A Package Cache</a>
    </li>
    <li>
      <a href="../articles/automated-pull-requests.html">Working with Automated Pull Requests</a>
    </li>
    <li class="divider"></li>
    <li>
      <a href="../articles/index.html">More...</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/carpentries/sandpaper/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Lesson Runtime Dependency Management</h1>
    <small class="dont-index">Source: <a href='https://github.com/carpentries/sandpaper/blob/master/R/manage_deps.R'><code>R/manage_deps.R</code></a></small>
    <div class="hidden name"><code>dependency_management.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>A customized provisioner for Carpentries Lessons based on
<span class="pkg">renv</span> that will install and maintain the requirements for the lesson
while <em>respecting user environments</em>. This setup leads to several
advantages:</p><ul>
<li><p><strong>reliable setup</strong>: the version of the lesson built on the carpentries
website will be the same as what you build on your computer because the
packages will be identical</p></li>
<li><p><strong>environmentally friendly</strong>: The lesson dependencies are NOT stored in
your default R library and they will not alter your R environment.</p></li>
<li><p><strong>transparent</strong>: any additions or deletions to the cache will be recorded
in the lockfile, which is tracked by git.</p></li>
</ul>

<p>The functions that control this cache are the following:</p><ol>
<li><p><code>manage_deps()</code>: Creates and updates the dependencies in your lesson.
If no lockfile exists in your lesson, this will create one for you.</p></li>
<li><p><code>update_cache()</code>: fetches updates for the dependencies and applies them
to your cache and lockfile.</p></li>
</ol>

<p>This is a wrapper around <code><a href='https://rstudio.github.io/renv/reference/record.html'>renv::record()</a></code>, which helps you record a package
or set of packages in your lockfile. It can be useful when you want to
upgrade or downgrade a specific package.</p>
    </div>

    <pre class="usage"><span class='fu'>manage_deps</span><span class='op'>(</span>
  path <span class='op'>=</span> <span class='st'>"."</span>,
  profile <span class='op'>=</span> <span class='st'>"lesson-requirements"</span>,
  snapshot <span class='op'>=</span> <span class='cn'>TRUE</span>,
  quiet <span class='op'>=</span> <span class='cn'>FALSE</span>
<span class='op'>)</span>

<span class='fu'>update_cache</span><span class='op'>(</span>
  path <span class='op'>=</span> <span class='st'>"."</span>,
  profile <span class='op'>=</span> <span class='st'>"lesson-requirements"</span>,
  prompt <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/interactive.html'>interactive</a></span><span class='op'>(</span><span class='op'>)</span>,
  quiet <span class='op'>=</span> <span class='op'>!</span><span class='va'>prompt</span>,
  snapshot <span class='op'>=</span> <span class='cn'>TRUE</span>
<span class='op'>)</span>

<span class='fu'>pin_version</span><span class='op'>(</span>records <span class='op'>=</span> <span class='cn'>NULL</span>, profile <span class='op'>=</span> <span class='st'>"lesson-requirements"</span>, path <span class='op'>=</span> <span class='st'>"."</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>path</th>
      <td><p>path to your lesson. Defaults to the current working directory.</p></td>
    </tr>
    <tr>
      <th>profile</th>
      <td><p>default to the profile for the lesson. Defaults to
<code>lesson-requirements</code>. Only use this if you know what you are doing.</p></td>
    </tr>
    <tr>
      <th>snapshot</th>
      <td><p>if <code>TRUE</code>, packages from the cache are added to the lockfile
(default). Setting this to <code>FALSE</code> will add packages to the cache and not
snapshot them.</p></td>
    </tr>
    <tr>
      <th>quiet</th>
      <td><p>if <code>TRUE</code>, output will be suppressed, defaults to <code>FALSE</code>,
providing output about different steps in the process of updating the local
dependencies.</p></td>
    </tr>
    <tr>
      <th>prompt</th>
      <td><p>if <code>TRUE</code>, a message will show you the packages that will be
updated in your lockfile and ask for your permission. This is the default
if it's running in an interactive session.</p></td>
    </tr>
    <tr>
      <th>records</th>
      <td><p>a character vector or list of packages/resources to include
in the lockfile. The most common way to do this is to use the
<code>[package]@[version]</code> syntax (e.g. <code>gert@0.1.3</code>), but there are other
specifications where you can specify the remote repository. See
<code><a href='https://rstudio.github.io/renv/reference/record.html'>renv::record()</a></code> for details.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>if <code>snapshot = TRUE</code>, a nested list representing the lockfile will be
returned.</p>
<p>the contents of the lockfile, invisibly</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The <span class="pkg">renv</span> package provides a very useful interface to bring one
aspect of reproducibility to R projects. Because people working on
Carpentries lessons are also working academics and will likely have
projects on their computer where the package versions are necessary for
their work, it's important that those environments are respected.</p>
<p>Our flavor of renv applies a package cache explicitly to the content of
the lesson, but does not impose itself as the default renv environment.</p>
<p>This provisioner will do the following steps:</p><ol>
<li><p>check for consent to use the package cache via <code><a href='use_package_cache.html'>use_package_cache()</a></code>
and prompt for it if needed</p></li>
<li><p>check if the profile has been created and create it if needed via
<code><a href='https://rstudio.github.io/renv/reference/init.html'>renv::init()</a></code></p></li>
<li><p>populate the cache with packages needed from the user's system and
download any that are missing via <code><a href='https://rstudio.github.io/renv/reference/hydrate.html'>renv::hydrate()</a></code>. This includes all
new packages that have been added to the lesson.</p></li>
<li><p>If there is a lockfile already present, make sure the packages in the
cache are aligned with the lockfile (downloading sources if needed) via
<code><a href='https://rstudio.github.io/renv/reference/restore.html'>renv::restore()</a></code>.</p></li>
<li><p>Record the state of the cache in a lockfile tracked by git. This will
include adding new packages and removing old packages. <code><a href='https://rstudio.github.io/renv/reference/snapshot.html'>renv::snapshot()</a></code></p></li>
</ol>

<p>When the lockfile changes, you will see it in git and have the power to
either commit or restore those changes.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='use_package_cache.html'>use_package_cache()</a></code> and <code><a href='use_package_cache.html'>no_package_cache()</a></code> for turning on and
off the package cache, respectively.</p></div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Zhian N. Kamvar.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


